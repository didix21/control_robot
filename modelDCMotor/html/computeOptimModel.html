
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>computeOptimModel</title><meta name="generator" content="MATLAB 8.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-09-01"><meta name="DC.source" content="computeOptimModel.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">close <span class="string">all</span>
clear <span class="string">all</span>
<span class="keyword">global</span> y u t;
load <span class="string">motorDreta.mat</span>

y = motorD(201:600,1);
a = 1;
</pre><pre class="codeinput">u=zeros(length(y),1);
a = 1;
<span class="keyword">for</span> j=1:(length(y)/100)
    <span class="keyword">switch</span> a
        <span class="keyword">case</span> 1
            <span class="keyword">for</span> i=1+(j-1)*100:100+(j-1)*100
                u(i)=p(1)*245^2+p(2)*245+p(3); <span class="comment">% pasem 245 pwm a rpm</span>
            <span class="keyword">end</span>
            a = 2;
        <span class="keyword">case</span> 2
            <span class="keyword">for</span> i=1+(j-1)*100:100+(j-1)*100
                u(i)=p(1)*165^2+p(2)*165+p(3);
            <span class="keyword">end</span>
            a = 1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
t = zeros(length(y),1);

<span class="keyword">for</span> i=2:(length(y))
    t(i) = t(i-1) + 0.1;
<span class="keyword">end</span>
</pre><pre class="codeinput">J = 1;
K = 1;
b = 1;
L = 1;
R=1;
params = [J b K R L];
newParams = fminsearch(@distance,params)
</pre><pre class="codeoutput">
A =

    -1     1
    -1     1


A =

   -0.9524    0.9524
   -1.0000    1.0000


A =

   -1.0500    1.0000
   -1.0000    1.0000


A =

   -1.0000    1.0500
   -1.0500    1.0000


A =

   -1.0000    1.0000
   -1.0000    1.0500


A =

   -1.0000    1.0000
   -0.9524    0.9524


A =

   -1.0000    1.0000
   -1.0000    0.9314


A =

   -1.0000    1.0000
   -1.0000    0.8738


A =

   -1.0000    0.9322
   -0.9322    0.9302


A =

   -1.0000    1.0198
   -1.0198    0.9821


A =

   -0.9324    0.9884
   -0.9884    0.9235


A =

   -1.0225    1.0543
   -0.9840    0.8943


A =

   -0.9812    1.0240
   -0.9780    0.8548


A =

   -0.9721    1.0356
   -0.9680    0.7890


A =

   -0.9703    1.0379
   -1.0311    0.8286


A =

   -0.9561    1.0559
   -1.0710    0.7658


A =

   -0.9529    1.0333
   -0.9852    0.7255


A =

   -1.0287    1.0838
   -1.0129    0.6995


A =

   -0.9450    1.0303
   -1.0286    0.6497


A =

   -0.9119    1.0200
   -1.0497    0.5344


A =

   -0.9278    1.0879
   -1.0320    0.5468


A =

   -0.8944    1.1285
   -1.0457    0.4065


A =

   -0.9239    1.0906
   -1.0973    0.4524


A =

   -0.9304    1.1144
   -1.1230    0.4110


A =

   -0.9205    1.1502
   -1.1891    0.2604


A =

   -0.8312    1.0947
   -1.1642    0.2676


A =

   -0.8450    1.1312
   -1.1404    0.0663


A =

   -0.8529    1.2130
   -1.1970    0.0624


A =

   -0.8190    1.1897
   -1.1899   -0.0005


A =

   -0.8949    1.1180
   -1.1230    0.3266


A =

   -0.9005    1.0319
   -1.0609    0.4819


A =

   -0.8644    1.1692
   -1.1651    0.1608


A =

   -0.9215    1.1332
   -1.1326    0.5347


A =

   -0.8621    1.1316
   -1.1387    0.1717


A =

   -0.8565    1.1362
   -1.2716    0.0569


A =

   -0.8839    1.1307
   -1.1001    0.3223


A =

   -0.8919    1.0796
   -1.1188    0.3842


A =

   -0.9075    1.0961
   -1.1389    0.4674


A =

   -0.8729    1.1232
   -1.1387    0.2402


A =

   -0.8688    1.1660
   -1.1653    0.1879


A =

   -0.8860    1.1015
   -1.1309    0.3332


A =

   -0.8932    1.1143
   -1.1436    0.3670


A =

   -0.8779    1.1210
   -1.1399    0.2709


A =

   -0.9598    1.1566
   -1.1088    0.3374


A =

   -0.8786    1.0993
   -1.0544    0.3734


A =

   -0.9103    1.1379
   -1.1544    0.2895


A =

   -0.9244    1.1649
   -1.1195    0.2863


A =

   -0.9446    1.1983
   -1.1141    0.2639


A =

   -0.9535    1.1633
   -1.1021    0.3540


A =

   -0.8958    1.1310
   -1.1305    0.2916


A =

   -0.9343    1.1703
   -1.1220    0.2851


A =

   -0.8624    1.1376
   -1.1412    0.2532


A =

   -0.9343    1.1516
   -1.1170    0.3161


A =

   -0.9556    1.1714
   -1.1576    0.2645


A =

   -0.9376    1.1612
   -1.1430    0.2792


A =

   -0.9406    1.1743
   -1.0994    0.2937


A =

   -0.9567    1.1937
   -1.0735    0.2957


A =

   -0.9815    1.2076
   -1.0993    0.2933


A =

   -1.0285    1.2496
   -1.0845    0.2941


A =

   -0.9728    1.2105
   -1.0650    0.3108


A =

   -0.9925    1.2176
   -1.0617    0.3157


A =

   -1.0328    1.2463
   -1.0425    0.3254


A =

   -0.9498    1.1840
   -1.0995    0.2965


A =

   -1.0293    1.2757
   -1.0396    0.2900


A =

   -1.0843    1.3474
   -1.0052    0.2784


A =

   -1.0000    1.2513
   -1.0672    0.2746


A =

   -0.9981    1.2429
   -1.0658    0.2846


A =

   -1.0691    1.3163
   -1.0198    0.2888


A =

   -1.0822    1.3292
   -1.0334    0.2667


A =

   -1.1607    1.4135
   -1.0111    0.2701


A =

   -1.2886    1.5512
   -0.9835    0.2588


A =

   -1.2314    1.4820
   -0.9856    0.2699


A =

   -1.3830    1.6375
   -0.9504    0.2634


A =

   -1.2433    1.4940
   -0.9809    0.2849


A =

   -1.4479    1.7510
   -0.9070    0.2585


A =

   -1.8055    2.1784
   -0.8398    0.2451


A =

   -1.7103    2.0266
   -0.8869    0.2454


A =

   -2.0863    2.4091
   -0.8586    0.2426


A =

   -2.0780    2.4282
   -0.8287    0.2522


A =

   -2.9460    3.3927
   -0.7679    0.2496


A =

   -2.9459    3.4136
   -0.7856    0.2221


A =

   -3.8306    4.4627
   -0.7528    0.2241


A =

   -1.6449    1.9628
   -0.8822    0.2636


A =

   -2.7328    3.1959
   -0.7796    0.2441


A =

   -3.8549    4.4790
   -0.7354    0.2436


A =

   -2.3731    2.8657
   -0.7721    0.2472


A =

   -2.5693    3.1781
   -0.7338    0.2493


A =

   -1.3666    1.6602
   -0.9012    0.2831


A =

   -2.6982    3.1748
   -0.7838    0.2364


A =

   -2.8734    3.3337
   -0.7771    0.2512


A =

   -3.9724    4.5226
   -0.7493    0.2539


A =

   -5.1379    5.9589
   -0.7124    0.2323


A =

   -2.8453    3.3257
   -0.7604    0.2536


A =

   -2.7332    3.2107
   -0.7779    0.2407


A =

   -5.1048    6.0206
   -0.7075    0.2351


A =

  -18.3140   21.6982
   -0.6604    0.2284


A =

   -4.1331    4.8571
   -0.7205    0.2425


A =

   -2.9854    3.5073
   -0.7628    0.2412


A =

   -4.3822    5.1829
   -0.7131    0.2383


A =

   -8.8715   10.0960
   -0.6992    0.2325


A =

   -2.9491    3.5066
   -0.7521    0.2432


A =

   -2.5792    3.0826
   -0.7733    0.2518


A =

   -2.4259    2.8540
   -0.7986    0.2510


A =

   -3.6414    4.3010
   -0.7328    0.2412


A =

   -3.8143    4.6095
   -0.7152    0.2342


A =

   -4.6184    5.7000
   -0.6879    0.2266


A =

   -4.3796    5.3296
   -0.6986    0.2374


A =

   -5.5131    6.6875
   -0.6884    0.2335


A =

   -9.8801   12.1052
   -0.6608    0.2293


A =

  -54.6225   66.5710
   -0.6346    0.2192


A =

  -42.0437   52.5332
   -0.6292    0.2191


A =

  -31.6453   40.5966
   -0.6199    0.2181


A =

   15.9593  -21.4208
   -0.5834    0.2110


A =

   -4.3665    5.5237
   -0.6828    0.2330


A =

 -124.7128  160.4394
   -0.6168    0.2142


A =

   15.7970  -20.3691
   -0.6002    0.2188


A =

   -6.7478    8.4190
   -0.6634    0.2245


A =

   -5.3574    6.8195
   -0.6674    0.2282


A =

   -7.0138    9.2628
   -0.6372    0.2174


A =

   -3.4628    4.3912
   -0.6955    0.2354


A =

   -4.8596    6.4045
   -0.6551    0.2277


A =

   -4.2075    5.7088
   -0.6509    0.2293


A =

  -27.3018   36.3131
   -0.6121    0.2160


A =

  -67.6922   92.2174
   -0.5965    0.2117


A =

    9.4663  -13.4136
   -0.5610    0.2029


A =

   78.0391 -108.6514
   -0.5834    0.2096


A =

   -7.1323    9.2770
   -0.6443    0.2231


A =

  -25.2592   33.6141
   -0.6114    0.2213


A =

   80.1972 -107.1332
   -0.5992    0.2231


A =

   -6.1955    8.6355
   -0.6247    0.2221


A =

   -4.2257    6.1618
   -0.6272    0.2242


A =

  -13.0849   18.8223
   -0.5954    0.2177


A =

  -25.9056   39.3808
   -0.5733    0.2153


A =

   -4.9964    7.4155
   -0.6092    0.2243


A =

   21.9169  -32.9663
   -0.5618    0.2105


A =

   -5.8144    8.0877
   -0.6260    0.2241


A =

   -3.6493    5.5242
   -0.6219    0.2325


A =

   -2.6966    4.4582
   -0.6103    0.2266


A =

   -3.5481    5.9812
   -0.5901    0.2247


A =

   -4.5528    7.7220
   -0.5752    0.2247


A =

   -4.7973    8.8880
   -0.5515    0.2250


A =

  -25.9225   40.1235
   -0.5681    0.2220


A =

 -171.4865  293.4175
   -0.5394    0.2132


A =

  164.3142 -307.2483
   -0.5246    0.2161


A =

   -6.3505    9.9322
   -0.5858    0.2220


A =

   10.5577  -16.6357
   -0.5389    0.2146


A =

   -5.4868    9.0897
   -0.5764    0.2220


A =

   -4.6851    8.5795
   -0.5543    0.2263


A =

  -11.7603   22.2618
   -0.5316    0.2212


A =

  -29.1946   61.9975
   -0.5074    0.2208


A =

  202.0603 -394.9160
   -0.5136    0.2208


A =

   -7.0533   12.1391
   -0.5596    0.2217


A =

   -4.0138    9.1513
   -0.5168    0.2207


A =

   -7.5243   16.7182
   -0.5088    0.2206


A =

   -2.3302    5.9891
   -0.5146    0.2320


A =

   -5.4193   14.7375
   -0.4878    0.2215


A =

   -6.4783   23.6188
   -0.4590    0.2194


A =

   -6.1478   23.2982
   -0.4561    0.2205


A =

  -22.1670  194.2195
   -0.4170    0.2187


A =

    6.5585  -17.5673
   -0.4654    0.2100


A =

   -3.4900    9.0627
   -0.5012    0.2260


A =

  134.6146 -448.3223
   -0.4574    0.2221


A =

   -4.9400   12.2077
   -0.5009    0.2211


A =

   28.3037  -77.8717
   -0.4710    0.2153


A =

   -4.7803   12.5907
   -0.4933    0.2232


A =

  -24.1997   72.5972
   -0.4684    0.2207


A =

   14.2035  -47.8175
   -0.4534    0.2206


A =

  -13.9290   58.7025
   -0.4467    0.2212


A =

   -1.7500   15.6140
   -0.4254    0.2211


A =

  -14.0627   36.4233
   -0.4853    0.2209


A =

    9.3216  -42.8696
   -0.4353    0.2182


A =

   -6.2703   18.4509
   -0.4777    0.2218


A =

  -17.5748   50.1342
   -0.4743    0.2228


A =

   48.0765 -166.0111
   -0.4546    0.2206


A =

   -8.3454   25.4940
   -0.4717    0.2215


A =

   -8.4528   39.0343
   -0.4425    0.2218


A =

  -89.2371  276.4294
   -0.4649    0.2226


A =

   22.5507  -64.1318
   -0.4693    0.2237


A =

   33.9014 -131.6139
   -0.4471    0.2221


A =

  -11.2250   36.2027
   -0.4654    0.2217


A =

  -53.4165  132.9260
   -0.4863    0.2218


A =

  -12.6110   47.7173
   -0.4530    0.2218


A =

  -22.7558   57.8301
   -0.4846    0.2227


A =

  -20.6151   58.0417
   -0.4747    0.2223


A =

 -129.3200  379.5522
   -0.4686    0.2224


A =

   36.4962 -102.5421
   -0.4702    0.2228


A =

 -187.1576  451.4796
   -0.4880    0.2226


A =

  -18.7248   61.8598
   -0.4615    0.2220


A =

  -58.9038  193.2656
   -0.4604    0.2219


A =

   82.9807 -285.1185
   -0.4555    0.2211


A =

  -23.7838   70.8351
   -0.4695    0.2223


A =

 -107.8274  348.5021
   -0.4615    0.2238


A =

  113.5484 -381.8622
   -0.4582    0.2253


A =

  148.3449 -500.5431
   -0.4574    0.2227


A =

  -32.2552   98.9557
   -0.4664    0.2224


A =

   53.7118 -158.5989
   -0.4672    0.2233


A =

  -29.6621   95.1472
   -0.4629    0.2223


A =

   1.0e+03 *

    1.5506   -5.0041
   -0.0005    0.0002


A =

  -42.7380  132.7510
   -0.4650    0.2225


A =

  187.0581 -570.0712
   -0.4652    0.2230


A =

  -42.4877  134.5152
   -0.4635    0.2225


A =

  -47.2967  150.4872
   -0.4627    0.2226


A =

 -132.2389  423.6813
   -0.4617    0.2227


A =

  -92.2034  277.5698
   -0.4668    0.2237


A =

 -122.6232  354.5833
   -0.4700    0.2246


A =

   1.0e+03 *

    0.6652   -1.9968
   -0.0005    0.0002


A =

  -58.7645  183.5340
   -0.4642    0.2228


A =

  -55.1960  184.0609
   -0.4595    0.2242


A =

  -40.7587  145.9848
   -0.4551    0.2251


A =

  -96.4738  317.0701
   -0.4602    0.2246


A =

 -148.2175  500.3044
   -0.4582    0.2255


A =

   1.0e+04 *

   -0.3105    1.0247
   -0.0000    0.0000


A =

  -86.3799  286.5064
   -0.4601    0.2273


A =

  -72.9524  246.3417
   -0.4593    0.2295


A =

  -86.5066  289.4141
   -0.4593    0.2285


A =

  -78.2594  266.5581
   -0.4582    0.2310


A =

  -61.8289  257.2805
   -0.4465    0.2302


A =

  215.9792 -737.7475
   -0.4577    0.2319


A =

  -58.8339  208.2022
   -0.4557    0.2268


A =

  -35.4344  136.0559
   -0.4513    0.2311


A =

  -33.3728  131.9940
   -0.4502    0.2339


A =

  -22.1270   95.9286
   -0.4462    0.2380


A =

  -35.2618  143.3853
   -0.4488    0.2372


A =

  -28.0954  123.6794
   -0.4454    0.2424


A =

  -21.7111  106.5495
   -0.4399    0.2395


A =

  -21.0153   85.2538
   -0.4498    0.2427


A =

  -15.8746   63.5858
   -0.4516    0.2492


A =

  -19.1111   86.2846
   -0.4451    0.2489


A =

  -14.6079   72.5541
   -0.4419    0.2580


A =

   -7.5564   51.0744
   -0.4319    0.2596


A =

  -11.1663   61.6609
   -0.4379    0.2615


A =

   -8.0469   51.9083
   -0.4336    0.2735


A =

   -8.9110   46.9951
   -0.4419    0.2742


A =

   -5.2691   35.3727
   -0.4347    0.2840


A =

   -3.2511   39.4423
   -0.4220    0.2903


A =

   -6.9997   42.5248
   -0.4379    0.2931


A =

   -6.7763   39.0937
   -0.4411    0.3110


A =

  -14.9692   58.1835
   -0.4543    0.2623


A =

  -11.2422   52.2228
   -0.4461    0.2694


A =

   -4.7102   32.0292
   -0.4356    0.3005


A =

   -3.4290   32.8353
   -0.4273    0.3006


A =

   -4.8378   36.3309
   -0.4320    0.2927


A =

   -3.5085   32.4679
   -0.4275    0.3033


A =

   -5.4846   40.7992
   -0.4319    0.3012


A =

   -5.6240   44.3083
   -0.4305    0.3100


A =

   -3.2735   28.2038
   -0.4317    0.3277


A =

   -4.0425   32.0229
   -0.4322    0.3136


A =

   -7.2178   42.2475
   -0.4398    0.3005


A =

   -6.3919   39.5141
   -0.4385    0.3146


A =

   -7.9929   52.0787
   -0.4360    0.3122


A =

   -5.9593   43.9341
   -0.4321    0.2973


A =

  -12.6434   72.7265
   -0.4382    0.2917


A =

   -8.1440   58.2974
   -0.4328    0.3116


A =

   -9.1502   72.1669
   -0.4302    0.3210


A =

   -8.8545   76.6403
   -0.4270    0.3121


A =

  -11.5225  132.7049
   -0.4207    0.3179


A =

  -16.9246  127.9225
   -0.4301    0.3240


A =

   -4.9588   67.7040
   -0.4204    0.3431


A =

   -8.8352  138.9643
   -0.4168    0.3341


A =

   1.0e+03 *

   -0.0199    1.2811
   -0.0004    0.0003


A =

    8.5602 -185.4078
   -0.4127    0.3507


A =

   -6.7758   62.9631
   -0.4261    0.3200


A =

   -8.1813  209.8267
   -0.4116    0.3389


A =

   15.6514 -508.5276
   -0.4098    0.3476


A =

   -7.6957   86.4046
   -0.4221    0.3269


A =

   49.0272 -668.5561
   -0.4163    0.3183


A =

   -6.8878   94.0111
   -0.4194    0.3368


A =

    2.1367  157.2703
   -0.4025    0.3419


A =

  -13.0167  133.9392
   -0.4231    0.3286


A =

   1.0e+03 *

   -0.0430    1.1982
   -0.0004    0.0003


A =

    1.7356 -210.5226
   -0.4051    0.3464


A =

   18.5479 -495.0992
   -0.4101    0.3313


A =

   -8.5983  133.6270
   -0.4170    0.3354


A =

   1.0e+03 *

   -0.0144    1.1651
   -0.0004    0.0004


A =

  -18.7377 -553.1767
   -0.3983    0.3581


A =

  -12.5465  190.4147
   -0.4169    0.3360


A =

    0.9773 -382.2395
   -0.4044    0.3515


A =

   -9.8156  199.2100
   -0.4139    0.3394


A =

   1.0e+03 *

   -0.0945    2.8600
   -0.0004    0.0003


A =

   15.8771 -528.8922
   -0.4102    0.3530


A =

   -3.8453 -447.2254
   -0.4029    0.3561


A =

  -13.9241  291.3651
   -0.4134    0.3410


A =

    3.1987 -384.7662
   -0.4057    0.3533


A =

  -12.4527  317.5396
   -0.4118    0.3429


A =

    5.8681 -921.5870
   -0.4056    0.3525


A =

  -16.2010  430.9013
   -0.4114    0.3439


A =

   13.0035 -893.8368
   -0.4070    0.3510


A =

  -15.8177  477.6704
   -0.4106    0.3449


A =

  -25.1493  554.0078
   -0.4130    0.3488


A =

   1.0e+04 *

   -0.0583    2.2055
   -0.0000    0.0000


A =

   18.6637 -899.7044
   -0.4083    0.3561


A =

   1.0e+03 *

    0.0516   -1.8240
   -0.0004    0.0004


A =

  -22.1890  695.2743
   -0.4104    0.3471


A =

   1.0e+03 *

   -0.0600    1.0729
   -0.0004    0.0003


A =

   1.0e+03 *

   -0.0269    1.1400
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0289    1.0247
   -0.0004    0.0004


A =

  -23.0910  953.3071
   -0.4099    0.3700


A =

   1.0e+03 *

    0.0338   -2.8987
   -0.0004    0.0004


A =

  -29.1024  785.5659
   -0.4115    0.3504


A =

   1.0e+04 *

    0.0689   -2.5132
   -0.0000    0.0000


A =

  -28.7228  932.6954
   -0.4103    0.3498


A =

   1.0e+04 *

   -0.0403    2.0428
   -0.0000    0.0000


A =

   1.0e+03 *

    0.1343   -6.2293
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0372    1.3052
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0236    1.3542
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1647    6.7072
   -0.0004    0.0004


A =

   1.0e+03 *

    0.1149   -4.5848
   -0.0004    0.0004


A =

  -29.7317  979.4681
   -0.4104    0.3582


A =

   1.0e+03 *

   -0.0554    2.4909
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0885    4.6501
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1177    3.3382
   -0.0004    0.0004


A =

  -27.1218  907.9274
   -0.4108    0.3671


A =

   1.0e+03 *

   -0.0890    3.2634
   -0.0004    0.0004


A =

   1.0e+03 *

    0.1455   -5.8946
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0400    1.3816
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0237    1.3790
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0759    2.4680
   -0.0004    0.0004


A =

   1.0e+03 *

    0.1398   -5.5193
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0400    1.4567
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0410    1.5586
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1256    5.3190
   -0.0004    0.0004


A =

   1.0e+04 *

    0.0255   -1.2186
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.0448    2.3724
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0614    3.2782
   -0.0000    0.0000


A =

   1.0e+03 *

    0.0473   -3.3093
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1899    6.9551
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0548    2.4113
   -0.0004    0.0004


A =

   1.0e+03 *

    0.1136   -5.8196
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0561    2.2793
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0389    2.2351
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1135    4.5655
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0233    1.0187
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.0680    2.9850
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0284    1.2026
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0319   -1.3137
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0215   -1.0319
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.0776    3.2783
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1085    4.9690
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1190    6.1416
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1145    4.8767
   -0.0004    0.0004


A =

   1.0e+05 *

    0.0474   -2.1770
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.0901    4.0000
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.0706    2.5868
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1743    8.3476
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1294    5.4331
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1134    5.0778
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0587    2.7359
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0207   -1.0178
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0330    1.4874
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.1436    6.9932
   -0.0004    0.0004


A =

   1.0e+03 *

   -0.1664    7.8119
   -0.0004    0.0004


A =

   1.0e+04 *

    0.1915   -9.6877
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.1490    6.6059
   -0.0004    0.0004


A =

   1.0e+04 *

    0.1057   -5.0296
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.1542    7.0074
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0345    1.5065
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.2010    9.3955
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.1248    6.0089
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0390   -1.9636
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0499   -2.2867
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0226    1.0536
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0546   -2.6150
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0223    1.0258
   -0.0000    0.0000


A =

   1.0e+03 *

   -0.1529    7.4478
   -0.0004    0.0004


A =

   1.0e+04 *

   -0.0565    2.5939
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0298    1.3889
   -0.0000    0.0000


A =

   1.0e+04 *

    0.1312   -6.1150
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0319    1.4902
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0676   -3.2147
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0330    1.5301
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0516    2.4154
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0703    3.3234
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0744   -3.5494
   -0.0000    0.0000


A =

   1.0e+04 *

    0.0868   -4.1009
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0483    2.2605
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0322    1.5562
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0551    2.6671
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0697    3.3421
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0389   -1.8914
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0664    3.1385
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0326   -1.5911
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0717    3.3908
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0563    2.6369
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.1457    6.9889
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0258    1.2190
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0651   -3.1180
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0913    4.3294
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0615   -2.9430
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0991    4.7009
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.0900    4.3239
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.1767    8.3789
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0555    2.6556
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0352   -1.6938
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0419    1.9697
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0574    2.6893
   -0.0000    0.0000


A =

   1.0e+04 *

    0.2065   -9.7367
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.1577    7.4702
   -0.0000    0.0000


A =

   1.0e+04 *

   -0.1871    8.9663
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0802    3.8142
   -0.0000    0.0000


A =

   1.0e+05 *

    0.1033   -4.9169
   -0.0000    0.0000


A =

   1.0e+08 *

    0.0421   -1.9735
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0251    1.1959
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0282    1.3547
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0625   -3.0001
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0229    1.0861
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1033    4.9203
   -0.0000    0.0000


A =

   1.0e+05 *

    0.1856   -8.8369
   -0.0000    0.0000


A =

   1.0e+05 *

    0.1242   -5.9380
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0324    1.5421
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0351    1.6932
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0564    2.6789
   -0.0000    0.0000


A =

   1.0e+07 *

   -0.0283    1.3380
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0376    1.8004
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0350    1.6727
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0891   -4.2630
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1028    4.8771
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0849    4.0338
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1322    6.3250
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0413    1.9805
   -0.0000    0.0000


A =

   1.0e+05 *

    0.0931   -4.4270
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0581    2.7773
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1961    9.3973
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0325    1.5608
   -0.0000    0.0000


A =

   1.0e+05 *

    0.1252   -6.0070
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.0915    4.3776
   -0.0000    0.0000


A =

   1.0e+08 *

   -0.0501    2.4135
   -0.0000    0.0000


A =

   1.0e+05 *

    0.1790   -8.6217
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1466    7.0255
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0242    1.1667
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0315    1.5091
   -0.0000    0.0000


A =

   1.0e+06 *

    0.0761   -3.6656
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0209    1.0006
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0319    1.5304
   -0.0000    0.0000


A =

   1.0e+05 *

   -0.1354    6.4539
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0533    2.5605
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0671    3.2160
   -0.0000    0.0000


A =

   1.0e+07 *

    0.0627   -3.0079
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0410    1.9726
   -0.0000    0.0000


A =

   1.0e+06 *

    0.1771   -8.5150
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0271    1.3008
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0295    1.4136
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0443    2.1286
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0993    4.7696
   -0.0000    0.0000


A =

   1.0e+07 *

    0.0298   -1.4308
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.1409    6.7823
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.1388    6.6602
   -0.0000    0.0000


A =

   1.0e+07 *

   -0.0350    1.6814
   -0.0000    0.0000


A =

   1.0e+06 *

    0.1430   -6.8649
   -0.0000    0.0000


A =

   1.0e+06 *

    0.1353   -6.4995
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0612    2.9392
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0751    3.6107
   -0.0000    0.0000


A =

   1.0e+06 *

   -0.0849    4.0774
   -0.0000    0.0000


newParams =

    0.0000    0.0212    1.0162    0.9110    2.4849

</pre><pre class="codeinput">J = newParams(1);
b = newParams(2);
K = newParams(3);
R = newParams(4);
L = newParams(5);

A=[-b/J K/J; -K/L R/L]
B=[0; 1/L];
C=[1,0];
D=0;

sys_model=ss(A,B,C,D);
[y_model,t] = lsim(sys_model,u,t);
plot(t,y_model,<span class="string">'r'</span>);
hold <span class="string">on</span>
plot(t,y);
title (<span class="string">'Gr&agrave;fica de parametres estimats'</span>);
xlabel (<span class="string">'Temps (Segons)'</span>);
ylabel (<span class="string">'Velocitat'</span>);
legend(<span class="string">'y_m_o_d_e_l'</span>,<span class="string">'y'</span>);
</pre><pre class="codeoutput">
A =

   1.0e+07 *

   -0.0350    1.6814
   -0.0000    0.0000

</pre><img vspace="5" hspace="5" src="computeOptimModel_01.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014a</a><br></p></div><!--
##### SOURCE BEGIN #####
close all
clear all
global y u t;
load motorDreta.mat

y = motorD(201:600,1);
a = 1;

%%

u=zeros(length(y),1);
a = 1;
for j=1:(length(y)/100)
    switch a
        case 1
            for i=1+(j-1)*100:100+(j-1)*100
                u(i)=p(1)*245^2+p(2)*245+p(3); % pasem 245 pwm a rpm 
            end
            a = 2;
        case 2
            for i=1+(j-1)*100:100+(j-1)*100
                u(i)=p(1)*165^2+p(2)*165+p(3);
            end
            a = 1;
    end
end
t = zeros(length(y),1);

for i=2:(length(y))
    t(i) = t(i-1) + 0.1;
end
%%
J = 1;
K = 1;
b = 1;
L = 1;
R=1;
params = [J b K R L];
newParams = fminsearch(@distance,params)
%%
J = newParams(1);
b = newParams(2);
K = newParams(3);
R = newParams(4);
L = newParams(5);

A=[-b/J K/J; -K/L R/L]
B=[0; 1/L];
C=[1,0];
D=0;

sys_model=ss(A,B,C,D);
[y_model,t] = lsim(sys_model,u,t);
plot(t,y_model,'r');
hold on
plot(t,y);
title ('Gràfica de parametres estimats');
xlabel ('Temps (Segons)');
ylabel ('Velocitat');
legend('y_m_o_d_e_l','y');
##### SOURCE END #####
--></body></html>